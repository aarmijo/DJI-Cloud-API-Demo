## Function Overview

The live flight controls function is provided to solve the restriction that the drone and DJI Dock can not be immediately operated during the remote controlling process. At real scenes, the drone can response from idle state or pause the executing flight mission. Developer can control the device or payload through manual method. Through the live flight controls function, developer can get safe and reliable drone control, high real-time command sending and live streaming screen transmission, osd information pushing and payload control ability.

Live flight controls APIs can be divided into flight control commands (DRC commands), payload control commands, flyto commands and one-key taking off commands.

* Flight control commands (DRC commands)
  
  Drone Remote Control (DRC) uses MQTT protocol and add two new topics to represents upward link and downward link. [MQTT Topic Definition](https://developer.dji.com/doc/cloud-api-tutorial/en/api-reference/dock-to-cloud/mqtt/topic-definition.html) provides introduction and example of drc Topic structure. After the server and device successfully build MQTT link, an EMQX Broker will be distributed to the DRC communication link from server to device for faster transmission and response. To use DRC commands, the live flight controls control mode should be entered in advanced. DRC commands usually do not limited by flight control authority, but the `DRC-flight control Method: drone_control` must need the flight control authority.

<div>
<div div style="text-align: center"><p>Figure. DRC link</p></div>
<div align=center>
<img src="https://terra-1-g.djicdn.com/71a7d383e71a4fb8887a310eb746b47f/cloudapi/v1.4/DRC-link.png" style="width:auto"/>
</div></div>

* Payload control commands: All the payload control commands require payload control authority. Current payload control commands control the camera and gimbal actions to realize the payload operations like photo taking, camera zooming in or zooming out, gimbal reset and so on. Therefore the target information can be obtained through these payload operations.

* Flyto commands and one-key taking off commands: flyto commands and one-key taking off commands are used to make the drone fly to the target point and hover. The difference is at the applicable scene. The flyto commands are applicable when the drone is in the air. The one-key taking off commands are applicable when the drone is in the dock. If developer uses the one-key taking off command to make the drone reach the target point, flyto commands can be continuously issued later. Currently, single target point is supported. 

### Simulated Debugging

Live flight controls newly supports simulated flights. Once the simulator is enabled, the aircraft will go through the preparatory steps for the flight mission, such as opening the dock cover and starting up. The aircraft will follow the specified longitude and latitude fields of `simulate_mission` API as the starting point data for the flight mission execution, but aircraft will not actually take off. The aircraft's data during the execution of the task will be reported as usual via the `osd`. 

> **Note:** Simulated flight mission will not enable RTK. After the simulated debugging, if outdoor flight mission is going to execute, stable RTK signal should be obtained for normal and safe execution.

### Live Flight Controls 2.0
CloudAPI V1.7 has introduced Live flight controls 2.0, providing safer and more intelligent flight behaviors.

* For the "Method: takeoff_to_point", if the "Method: security_takeoff_height" and the "Method: commander_flight_height" have different height values, the aircraft will climb to the higher of the two heights.

* For the "Method: fly_to_point", the aircraft will climb to the specified "Method: commander_flight_height". Developers can adjust this flight height by setting the "commander_flight_height" field(rw) in the aircraft's thing model. This height adjustment is globally effective.

Live flight controls 2.0 is backward compatible with Live flight controls 1.0. If you use Live flight controls 2.0 with compatible firmware but send Live flight controls 1.0 protocol content:

* For the "Method: takeoff_to_point", the "commander_flight_height" field will be set to 2 meters.
* For the "Method: fly_to_point", the aircraft will use the default minimum value (2 meters) for the "commander_flight_height" field as the flight height.


## Interaction Sequence Diagram

> **Note:** To avoid the drone damage, executing the flight control authority seizure and payload control authority seizure are recommended before issue the live flight controls APIs.

<div align=center>
<img src="https://terra-1-g.djicdn.com/71a7d383e71a4fb8887a310eb746b47f/cloudapi/v1.4/command-flight-working-scenes-en.png" style="width:auto"/>
</div>

## Detailed API Realization

> **Notes:** Only when the drone is in the air, the media files generated by the payload control commands will be pushed by the media management function.

[Live Flight Controls](https://developer.dji.com/doc/cloud-api-tutorial/en/api-reference/dock-to-cloud/mqtt/dock/dock1/drc.html)

* Flight control commands (DRC commands)
* Payload control commands
* flyto commands
* One-key taking off commands

[Remote Control](https://developer.dji.com/doc/cloud-api-tutorial/en/api-reference/pilot-to-cloud/mqtt/rc-pro/remote-control.html)
